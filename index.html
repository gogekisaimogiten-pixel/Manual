<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0f17" />
  <title>èªåŠ‡ç¥­ æ¨¡æ“¬åº— çµ±æ‹¬ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</title>
  <style>
    :root{
      --bg:#070a10; --card:#0c1220; --card2:#0a1222;
      --txt:#e9eefc; --muted:#a7b3d1; --line:rgba(255,255,255,.08);
      --accent:#7aa2ff; --danger:#ff6b6b;
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:radial-gradient(1200px 700px at 20% 0%, #0f1b3a 0%, var(--bg) 55%) fixed;
      color:var(--txt); font-family:-apple-system,BlinkMacSystemFont,"Hiragino Sans","Noto Sans JP",system-ui,Segoe UI,Roboto,Helvetica,Arial;
    }
    .wrap{max-width:980px;margin:0 auto;padding:24px 14px 56px}
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line); border-radius:18px; padding:18px;
      box-shadow:0 18px 50px rgba(0,0,0,.35);
    }
    .title{
      display:flex; gap:10px; align-items:flex-start; margin:0 0 10px;
      font-weight:800; letter-spacing:.02em; font-size:26px; line-height:1.2;
    }
    .sub{margin:0 0 14px; color:var(--muted); line-height:1.6}
    .row{display:flex; gap:10px; align-items:center; flex-wrap:wrap}
    input{
      flex:1; min-width:180px;
      padding:14px 14px; border-radius:14px;
      border:1px solid var(--line); outline:none;
      background:rgba(0,0,0,.22); color:var(--txt);
      font-size:16px;
    }
    button{
      padding:12px 14px; border-radius:14px; border:1px solid var(--line);
      background:rgba(122,162,255,.16); color:var(--txt);
      font-weight:700; font-size:16px;
    }
    button:active{transform:translateY(1px)}
    .smallbtn{background:rgba(255,255,255,.06)}
    .err{margin-top:10px;color:var(--danger);font-weight:700;display:none}
    .ok{margin-top:10px;color:#7dffb2;font-weight:700;display:none}

    #app{display:none}
    .hr{height:1px;background:var(--line);margin:14px 0}
    .hint{color:var(--muted);font-size:13px;line-height:1.5}
  </style>
</head>
<body>
  <div class="wrap">

    <!-- LOCK SCREEN -->
    <div id="lockScreen" class="card">
      <h1 class="title">ğŸ”’ ã“ã®ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™</h1>
      <p class="sub">çµ±æ‹¬å‘ã‘ã®å†…å®¹ï¼ˆæ©Ÿå¯†/æ³¨æ„äº‹é …ï¼‰ã‚’å«ã¿ã¾ã™ã€‚é–¢ä¿‚è€…ã®ã¿é–²è¦§ã—ã¦ãã ã•ã„ã€‚</p>

      <div class="row">
        <input id="pw" type="password" inputmode="text" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" autocomplete="current-password" />
        <button id="unlockBtn" type="button">é–‹ã</button>
      </div>

      <div class="row" style="margin-top:10px;">
        <label style="display:flex;gap:8px;align-items:center;color:var(--muted);">
          <input id="remember" type="checkbox" style="width:18px;height:18px;flex:none;" checked />
          ã“ã®ç«¯æœ«ã§è¨˜æ†¶
        </label>
        <button id="helpHashBtn" type="button" class="smallbtn">ç®¡ç†è€…ï¼šãƒãƒƒã‚·ãƒ¥ä½œæˆ</button>
        <button id="logoutBtn" type="button" class="smallbtn" style="display:none;">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
      </div>

      <div id="err" class="err"></div>
      <div id="ok" class="ok"></div>

      <div class="hr"></div>
      <div class="hint">
        â€»ã“ã‚Œã¯ã€Œé‹ç”¨ãƒ­ãƒƒã‚¯ã€ã§ã™ã€‚GitHub Pagesã«ç½®ãä»¥ä¸Šã€å®Œå…¨ãªç§˜åŒ¿ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br/>
        ã§ã‚‚é–¢ä¿‚è€…ä»¥å¤–ãŒã‚µã‚¯ãƒƒã¨èª­ã‚ãªã„ã‚ˆã†ã«ã™ã‚‹ç›®çš„ã«ã¯ååˆ†åŠ¹ãã¾ã™ã€‚
      </div>
    </div>

    <!-- APP -->
    <div id="app" class="card">
      <h1 class="title">èªåŠ‡ç¥­ æ¨¡æ“¬åº— çµ±æ‹¬ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ï¼ˆæ•´ç†ç‰ˆï¼‰</h1>
      <p class="sub">ãƒŠãƒŠãƒ¡èª­ã¿â†’å¿…è¦ãªç« ã ã‘æ·±æ˜ã‚Šã€‚æ¤œç´¢ã‚‚ã—ã‚„ã™ã„æ§‹æˆã€‚</p>
      <div class="hr"></div>

      <!-- ã“ã“ã«æœ¬æ–‡ã‚’è²¼ã‚‹ -->
      <div>
        <p>ï¼ˆã“ã“ã«ãƒãƒ‹ãƒ¥ã‚¢ãƒ«æœ¬æ–‡ã‚’ã‚³ãƒ”ãƒšï¼‰</p>
      </div>

    </div>

  </div>

<script>
(() => {
  // âœ… SHA-256("mmm") ã¯ã“ã‚Œï¼ˆã‚ãªãŸã®ä»Šã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
  const PASSWORD_HASH = "8b7293f6dd93853c83bf8c87ec5349a41789fa166a9431f108edb538e6fd82fd";
  const LS_KEY = "mogiten_manual_authed_v1";

  const lockScreen = document.getElementById("lockScreen");
  const app = document.getElementById("app");
  const err = document.getElementById("err");
  const ok = document.getElementById("ok");
  const pw = document.getElementById("pw");
  const remember = document.getElementById("remember");
  const unlockBtn = document.getElementById("unlockBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const helpHashBtn = document.getElementById("helpHashBtn");

  function showErr(msg){
    err.textContent = msg;
    err.style.display = "block";
    ok.style.display = "none";
  }
  function showOk(msg){
    ok.textContent = msg;
    ok.style.display = "block";
    err.style.display = "none";
  }

  async function sha256Hex(str){
    const enc = new TextEncoder().encode(str);
    const buf = await crypto.subtle.digest("SHA-256", enc);
    return [...new Uint8Array(buf)].map(b => b.toString(16).padStart(2, "0")).join("");
  }

  function unlockUI(){
    lockScreen.style.display = "none";
    app.style.display = "block";
    logoutBtn.style.display = "inline-block";
  }
  function lockUI(){
    app.style.display = "none";
    lockScreen.style.display = "block";
    logoutBtn.style.display = "none";
  }

  // åˆæœŸï¼šè¨˜æ†¶ãŒã‚ã‚Œã°è‡ªå‹•è§£é™¤
  try{
    if (localStorage.getItem(LS_KEY) === "1") unlockUI();
  }catch(e){ /* ignore */ }

  unlockBtn.addEventListener("click", async () => {
    err.style.display = "none";
    ok.style.display = "none";

    const input = (pw.value ?? "").trim();
    if (!input){
      showErr("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
      return;
    }

    try{
      const h = await sha256Hex(input);
      if (h === PASSWORD_HASH){
        if (remember.checked){
          try{ localStorage.setItem(LS_KEY, "1"); }catch(e){}
        }else{
          try{ localStorage.removeItem(LS_KEY); }catch(e){}
        }
        unlockUI();
      }else{
        showErr("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™ã€‚");
      }
    }catch(e){
      showErr("æš—å·å‡¦ç†ã«å¤±æ•—ã—ã¾ã—ãŸã€‚Safariã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚");
    }
  });

  pw.addEventListener("keydown", (e) => {
    if (e.key === "Enter") unlockBtn.click();
  });

  logoutBtn.addEventListener("click", () => {
    try{ localStorage.removeItem(LS_KEY); }catch(e){}
    pw.value = "";
    lockUI();
    showOk("ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚");
  });

  helpHashBtn.addEventListener("click", async () => {
    const p = prompt("ç®¡ç†è€…ç”¨ï¼šãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã™ã‚‹ã¨ SHA-256 ã‚’è¡¨ç¤ºã—ã¾ã™");
    if (p == null) return;
    const h = await sha256Hex(p);
    alert("SHA-256ï¼ˆã“ã‚Œã‚’ PASSWORD_HASH ã«è²¼ã‚‹ï¼‰:\n\n" + h);
  });

})();
</script>

</body>
</html>